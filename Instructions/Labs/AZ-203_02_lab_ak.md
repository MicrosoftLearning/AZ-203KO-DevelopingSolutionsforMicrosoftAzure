---
lab:
    title: '랩: 서비스형 Azure 플랫폼에서 웹 응용 프로그램 만듭니다.'
    type: '답변 키'
    module: '모듈 2: 서비스(PaaS) 컴퓨팅 솔루션으로 Azure 플랫폼 개발합니다'
---

# 랩: 서비스형 Azure 플랫폼에서 웹 응용 프로그램 만듭니다.
# 학생 랩 답변 키

## Microsoft Azure 사용자 인터페이스

Microsoft 클라우드 도구의 동적 특성을 감안할 때 이 교육 콘텐츠를 개발한 후 Azure 사용자 인터페이스(UI) 변경 사항이 발생할 수 있습니다. 이러한 변경으로 인해 랩 지침 및 단계가 일치하지 않을 수 있습니다.

Microsoft 전 세계 학습 팀은 커뮤니티에서 필요한 변경 사항을 가져오는 즉시 이 교육 과정을 업데이트합니다. 그러나 클라우드 업데이트가 자주 발생하기 때문에 이 교육 콘텐츠가 업데이트되기 전에 UI가 변경될 수 있습니다. **이 경우 변경 사항에 적응하고 필요에 따라 랩에서 작업합니다.**

## 지침

### 시작하기 전에

#### 랩 가상 기계에 로그인

  - 다음 자격 증명을 사용하여 **Windows 10** 가상 기계에 로그인합니다.
    
    1.  **사용자 이름**: 관리자
    
    2.  **비밀번호**: Pa55w.rd

> > **참고**: 랩 가상 기계 로그인 지침은 교수자를 통하여 제공합니다.

#### 설치된 응용 프로그램 검토

  - **Windows 10** 바탕 하단에 있는 작업 표시줄을 관찰합니다. 작업 표시줄에는 이 랩에서 사용할 응용 프로그램에 대한 아이콘이 포함되어 있습니다.
    
      - 마이크로소프트 에지
    
      - 파일 탐색기
    
      - Windows PowerShell
    
      - Visual Studio Code

#### 랩 파일 다운로드

1.  작업 표시줄에서 **Windows PowerShell** 아이콘을 선택합니다.

2.  PowerShell 명령 프롬프트에서 현재 작업 디렉토리를 **Allfiles(F):\\** 경로로 변경합니다.

    ```
    cd F:
    ```

3.  명령 프롬프트 내에서 다음 명령을 입력하고 Enter 를 누르며 GitHub 에서 호스팅되는 **microsoftlearning/AZ-203-DevelopingSolutionsForAzure** 프로젝트를 **랩파일** 디렉토리로 복제합니다.

    ```
    git clone --depth 1 --no-checkout https://github.com/microsoftlearning/AZ-203-DevelopingSolutionsForMicrosoftAzure .
    ```

4.  명령 프롬프트 내에서 다음 명령을 입력하고 **Enter** 를 눌러 **AZ-203.02** 랩을 완료할 때 필요한 랩 파일을 체크 아웃합니다.

    ```
    git checkout master -- Allfiles/*
    ```

5.  현재 실행 중인 **Windows PowerShell** 명령 프롬프트 응용 프로그램을 닫습니다.

### 연습 1: Azure 저장소 및 API 어플을 사용하여 백 엔드 API 를 구축합니다.

#### 작업 1: Azure 포털 열기

1.  작업 표시줄에서 **Microsoft Edge** 아이콘을 선택합니다.

2.  열린 브라우저 창에서 [**Azure portal**](https://portal.azure.com)(portal.azure.com)으로 이동합니다.

3.  로그인 페이지에서 Microsoft 계정의 **전자 메일 주소** 를 입력합니다.

4.  **다음** 을 선택합니다.

5.  Microsoft 계정의 **비밀번호** 를 입력합니다.

6.  **로그인** 을 선택합니다.

> **참고**: Azure 포털에 처음 로그인하는 경우 포털 둘러보기를 제공하는 대화 박스가 표시됩니다. 둘러보기를 건너뛰고 포털 사용을 시작하려면 **시작하기** 를 선택합니다.

#### 작업 2: Azure 저장소 계정 만들기

1.  Azure 포털의 왼쪽 네비게이션 페인에서 **모든 서비스** 를 선택합니다.

2.  **모든 서비스** 블레이드에서 **저장소 계정** 을 선택합니다.

3.  **저장소 계정** 블레이드에서 저장소 인스턴스 목록을 봅니다.

4.  **저장소 계정** 블레이드 상단에서 **추가** 를 선택합니다.

5.  **저장소 계정 만들기** 블레이드에서 기본 태그 및 검토+만들기와 같은 블레이드 상단의 탭을 관찰합니다.

> **참고**: 각 탭은 새 **저장소 계정** 을 만드는 워크플로의 단계를 나타냅니다. 언제든지 **검토 + 만들기** 를 선택하여 나머지 탭을 건너뛸 수 있습니다.

6.  **기본** 탭을 선택하고 탭 영역 내에서 다음 작업을 수행합니다.
    
    1.  **구독** 필드를 기본값으로 설정합니다.
    
    2.  **리소스 그룹** 섹션에서 **새 만들기** 를 선택하고 **관리 플랫폼** 을 입력한 다음 **OK** 를 선택합니다.
    
    3.  **저장소 계정** **이름** 필드에서 **imgstor\[*your name in lowercase*\]** 를 입력합니다.
    
    4.  **위치** 목록에서 **미국 동부** 지역을 선택합니다.
    
    5.  **성능** 섹션에서 **표준** 을 선택합니다.
    
    6.  **계정 종류** 목록에서 **StorageV2(일반용 v2)** 를 선택합니다.
    
    7.  **복제** 목록에서 **영역 중복 저장소(ZRS)** 를 선택합니다.
    
    8.  **액세스 계층** 섹션에서 **핫** 이 선택되어 있는지 확인합니다.
    
    9.  **검토 + 만들기** 를 선택합니다.

7.  **검토+ 만들기** 탭에서 이전 단계에서 지정한 옵션을 검토합니다.

8.  지정된 구성을 사용하여 저장소 계정을 만들려면 **만들기** 를 선택합니다.

9.  이 랩을 진행하기 전에 만들기 작업이 완료될 때까지 기다립니다.

10. Azure 포털의 왼쪽 네비게이션 페인에서 **모든 서비스** 를 선택합니다.

11. **모든 서비스** 블레이드에서 **저장소 계정** 을 선택합니다.

12. 표시되는 **저장소 계정** 블레이드에서 이전에 랩에서 만든 **imgstor\*** 저장소 계정을 선택합니다.

13. **저장소 계정** 블레이드에서 블레이드 왼쪽에 있는 **설정** 섹션을 찾아 **액세스 키** 를 선택합니다.

14. **엑세스 키** 블레이드에서 키 중 하나를 선택하고 **연결 문자열** 필드 중 하나의 값을 기록합니다. 이 랩에서 나중에 이 값을 사용합니다.

> > **참고**: 어떤 연결 문자열을 선택하든 상관없습니다. 서로 교환할 수 있습니다.

#### 작업 3: 샘플 블랍 업로드

1.  Azure 포털 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

2.  **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

3.  **관리 플랫폼** 블레이드에서 이전엔 랩에서 만든 **imgstor\*** 저장소 계정을 선택합니다.

4.  **저장소 계정** 블레이드에서 블레이드 왼쪽에 있는 **블랍 서비스** 섹션에서 **블랍** 링크를 선택합니다.

5.  **블랍** 섹션에서 **+ 컨테이너** 를 선택합니다.

6.  **새 컨테이너** 창에서 다음 작업을 수행합니다.
    
    1.  **이름** 필드에 **이미지** 를 입력합니다.
    
    2.  **공용 액세스 수준** 목록에서 **B블랍(블랍에 대해서만 익명 읽기 액세스**) 을 선택합니다.
    
    3.  **확인** 을 선택합니다.

7.  **블랍** 섹션에서 + **컨테이너** 를 다시 선택합니다.

8.  **새 컨테이너** 창에서 다음 작업을 수행합니다.

<!-- end list -->

1.  **이름** 필드에 **이미지-섬네일** 을 입력합니다.

2.  **공용 액세스 수준** 목록에서 **B블랍(블랍에 대해서만 익명 읽기 액세스**) 을 선택합니다.

3.  **확인** 을 선택합니다.

<!-- end list -->

9.  **블랍** 섹션에서 새로 만든 **이미지** 컨테이너를 선택합니다.

10. **컨테이너** 블레이드에서 **업로드** 를 선택합니다.

11. 표시되는 **블랍 업로드** 창에서 다음 작업을 수행합니다.

<!-- end list -->

1.  **파일** 섹션에서 **폴더** 아이콘을 선택합니다.

2.  표시되는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Images** 으로 이동하여 **grilledcheese.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.

3.  **이미 존재하는 경우 덮어쓰기** 확인란이 선택되어 있는지 확인합니다.

4.  **업로드** 를 선택합니다.

<!-- end list -->

12. 이 랩을 계속하기 전에 블랍이 업로드될 때까지 기다립니다.

#### 작업 4: API 어플 만들기

1.  포털의 왼쪽 네비게인션 페인에서 **+ 리소스 만들기** 를 선택합니다.

2.  **새** 블레이드 상단에서 **마켓플레이스 검색** 필드를 찾습니다.

3.  검색 필드에 **API** 를 입력하고 Enter 를 누릅니다.

4.  **모든검색** 결과 블레이드에서 **API 어플** 결과를 선택합니다.

5.  **API 어플** 블레이드에서 **만들기** 를 선택합니다.

6.  두 번째 **API 어플** 블레이드에서 다음 작업을 수행합니다.
    
    1.  **어플 이름** 필드에 **i mgapi\[*your name in lowercase*\]** 를 입력합니다.
    
    2.  **구독** 필드를 기본값으로 설정합니다.
    
    3.  **리소스 그룹** 섹션에서 **기존 사용** 을 선택한 다음 **관리되는 플랫폼** 을 선택합니다.
    
    4.  **앱 서비스 계획/위치** 필드를 기본값으로 설정합니다.
    
    5.  **응용 프로그램 인사이트** 필드를 기본값으로 설정합니다.
    
    6.  **만들기** 를 선택합니다.

7.  이 랩을 진행하기 전에 만들기 작업이 완료될 때까지 기다립니다.

#### 작업 5: API 어플 구성

1.  포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

2.  **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

3.  **관리 플랫폼** 블레이드에서 이전에 랩에서 만든 **imgapi\*** API 어플을 선택합니다.

4.  **API 어플** 블레이드에서 **설정** 섹션의 블레이드 왼쪽에 있는 **응용 프로그램설정** 링크를 선택합니다.

5.  **응용 프로그램 설정** 섹션에서 다음 작업을 수행합니다.
    
    1.  **응용 프로그램 설정** 하위 섹션이 표시될 때까지 아래로 스크롤합니다.
    
    2.  **+ 새 설정 추가** 를 선택합니다.
    
    3.  **이름 입력** 필드에 **저장소 연결 문자열** 을 입력합니다.
    
    4.  **값을 입력** 필드에 이전에 랩에서 복사된 **저장소 연결 문자열** 을 입력합니다.
    
    5.  **슬롯 설정** 필드를 기본값으로 설정합니다.
    
    6.  블레이드 상단에 **저장** 을 선택합니다.

6.  랩을 진행하기 전에 응용 프로그램 설정이 유지될 때까지 기다립니다.

7.  **API 어플** 블레이드에서 **설정** 섹션의 블레이드 왼쪽에 **속성** 링크를 선택합니다.

8.  **속성** 섹션에서 **URL** 필드의 값을 복사합니다. 이 값은 랩에서 나중에 사용합니다.

#### 작업 6: ASP.NET 코어 웹 응용 프로그램을 API 어플에 배치합니다.

1.  작업 표시줄에서 **비주얼 스튜디오 코드** 아이콘을 선택합니다.

2.  **파일** 메뉴에서 폴더 **열기** 를 선택합니다.

3.  열리는 파일 탐색기 창에서 **Allfiles (F):\\Labfiles\\02\\Starter\\API ** 로 이동하여 **폴더 선택** 을 선택합니다.

4.  비주얼 스튜디오 코드 창의 **탐색기** 페인에서 **컨트롤러** 폴더를 확장하고 **ImagesController.cs** 파일을 두 번 클릭하여 편집기에서 파일을 엽니다.

5.  편집기에서 **ImagesController** 클래스에서 27 줄의 **GetCloudBlobContainer** 메서드 및 컨테이너를 검색하는 경우 사용한 코드를 관찰합니다.

6.  **ImagesController** 클래스에서 37 줄에서 **Get** 메서드 및 **이미지** 컨테이너에서 모든 블랍을 비동기적으로 검색하는 경우 사용한 코드를 관찰합니다.

7.  **ImagesController** 클래스에서 74 줄의 **Post** 메서드와 업로드된 이미지를 Azure Storage 에 유지하는 경우 사용한 코드를 관찰합니다.

8.  작업 표시줄에서 **Windows** **PowerShell** 아이콘을 선택합니다.

9.  열린 명령 프롬프트에서 다음 명령을 입력하고 Enter 를 눌러 Azure CLI 에 로그인합니다.

<!-- end list -->

    az login

10. 표시되는 **Microsoft Edge** 브라우저 창에서 다음 작업을 수행합니다.
    
    1.  Microsoft 계정의 **전자 메일 주소** 를 입력합니다.
    
    2.  **다음** 을 선택합니다.
    
    3.  Microsoft 계정의 **비밀번호** 를 입력합니다.
    
    4.  **로그인** 을 선택합니다.

11. 현재 열려 있는 **명령 프롬프트** 응용 프로그램으로 돌아갑니다. 로그인 프로세스가 완료될 때까지 기다립니다.

12. 명령 프롬프트에서 다음 명령을 입력하고 Enter 를 눌러 **ManagedPlatform** 리소스 그룹에 모든 **어플** 을 나열합니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform

13. 다음 명령을 입력하고 Enter 를 눌러 접두사 **imgapi\*** 가 있는 **어플** 을 찾습니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform --query "[?starts_with(name, 'imgapi')]"

14. 다음 명령을 입력하고 Enter 를 눌러 접두사 **imgapi\*** 가 있는 싱글 어플의 이름만 인쇄합니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform --query "[?starts_with(name, 'imgapi')].{Name:name}" --output tsv

15. 다음 명령을 입력하고 Enter 를 눌러 현재 디렉터리를 랩 파일을 포함된 **Allfiles (F):\\Labfiles\\02\\Starter\\API** 디렉토리로 변경합니다.

<!-- end list -->

    cd F:\Labfiles\02\Starter\API\

16. 다음 명령을 입력하고 Enter 를 눌러 이전에 랩에서 만든 **API 어플**에 **api.zip** 파일을 배치합니다.

<!-- end list -->

    az webapp deployment source config-zip --resource-group ManagedPlatform --src api.zip --name <name-of-your-api-app>

> > **참고**: **\<Name-of-your-api-app\>** 리플레이스 홀더를 이전에 랩에서 만든 API 어플의 이름으로 바꿉니다. 최근에 이전 단계에서 이 어플의 이름을 쿼리했습니다.

17. 이 랩을 진행하기 전에 배치가 완료될 때까지 기다립니다.

18. 포털의 왼쪽에서 **리소스 그룹** 링크를 선택합니다.

19. **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 찾아 선택합니다.

20. **관리 플랫폼** 블레이드에서 이전에 랩에서 만든 **imgapi\*** *API 어플* 을 선택합니다.

21. **API 어플** 블레이드에서 **찾아보기** 버튼을 선택합니다.

22. 웹사이트의 루트로 **GET** 요청을 수행하고 반환되는 JSON 배열을 관찰합니다. 이 배열에는 **Azure Storage** 계정에 업로드된 싱글 이미지의 URL이 포함되어야 합니다.

23. **Azure portal** 을 표시하는 브라우저 창으로 돌아갑니다.

#### 검토

이 연습에서는 Azure 에서 API 어플을 만든 다음 Azure CLI 및 Kudu의 zip 배치 유틸리티를 사용하여 ASP.NET Core 웹 응용 프로그램을 API 어플에 배치했습니다.

### 연습 2: Azure 웹 어플을 사용하여 프런트 엔드 웹 응용 프로그램 빌듭니다.

#### 작업 1: 웹 어플 만들기

1.  Azure 포털에서 왼쪽 네비게이션 페인에서 **+ 리소스 만들기** 를 선택합니다. 

2.  **새** 블레이드 상단에서 **마켓플레이스 검색** 필드를 찾습니다.

3.  검색 필드에 **웹** 을 입력하고 Enter 를 누릅니다.

4.  **모든** 검색 결과 블레이드에서 모든 **웹** **어플** 결과를 선택합니다.

5.  **웹** **어플** 블레이드에서 **만드기** 를 선택합니다.

6.  두 번째 **웹** **어플** 블레이드에서 다음 작업을 수행합니다.
    
    1.  **어플 이름** 필드에서 **imgweb\[*your name in lowercase*\]** 를 입력합니다.
    
    2.  **구독** 필드를 기본값으로 설정합니다.
    
    3.  **리소스 그룹** 섹션에서 **기존 사용** 을 선택한 다음 **관리되는 플랫폼** 을 선택합니다.
    
    4.  **공용** 섹션에서 **코드** 를 선택합니다.
    
    5.  **런타임 스택** 섹션에서 **NET 코어 2.2** 를 선택합니다.
    
    6.  **OS** 섹션에서 **Windows** 를 선택합니다.
    
    7.  **앱 서비스 계획/위치** 필드를 기본값으로 설정합니다.
    
    8.  **응용 프로그램 인사이트** 필드를 기본값으로 설정합니다.
    
    9.  **만들기** 를 선택합니다.

7.  이 랩을 진행하기 전에 만들기 작업이 완료될 때까지 기다립니다.

#### 작업 2: 웹 어플 구성

1.  포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

2.  **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

3.  **관리 플랫폼** 블레이드에서 이전엔 랩에서 만든 **imgweb\*** 웹 어플을 선택합니다.

4.  **웹 어플** 블레이드에서 블레이드 왼쪽에 있는 **설정** 섹션에서**응용 프로그램** 설정 링크를 선택합니다.

5.  **응용 프로그램 설정** 섹션에서 다음 작업을 수행합니다.
    
    7.  **프로그램 설정** 하위 섹션이 표시될 때까지 아래로 스크롤합니다.
    
    8.  **+새 설정 추가** 를 선택합니다.
    
    9.  **이름 입력** 필드에 **ApiUrl** 를 입력합니다.
    
    10. **값 입력** 필드에 이전에 랩에서 복사된 API 어플 **URL** 을 입력합니다.
    
    11. **슬롯 설정** 필드를 기본값으로 설정합니다.
    
    12. 블레이드 상단에 **저장** 을 선택합니다.

6.  랩을 진행하기 전에 응용 프로그램 설정이 유지될 때까지 기다립니다.

#### 작업 3: ASP.NET 코어 웹 응용 프로그램을 웹 어플에 배치합니다.

1.  작업 표시줄에서 **비주얼 스튜디오 코드** 아이콘을 선택합니다.

2.  **파일** 메뉴에서 폴더 **열기** 를 선택합니다.

3.  열리는 파일 탐색기 페인에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Web** 으로 이동한 다음 **폴더 선택** 을 선택합니다.

4.  비주얼 스튜디오 코드 창의 **탐색기** 페인에서 **페이지** 폴더를 확장하고 **Index.cshtml.cs** 파일을 두 번 클릭하여 편집기에서 파일을 엽니다.

5.  편집기에서 **IndexModel** 클래스에서 30줄의 **OnGetAsync** 메서드 및 API에서 이미지 목록을 검색하는 경우 사용하는 코드를 관찰합니다.

6.  **IndexModel** 클래스에서 52줄에 있는 **OnPostAsync** 메서드 및 업로드된 이미지를 백 엔드 API로 스트리하는 경우 사용하는 코드를 관찰합니다.

7.  작업 표시줄에서 **Windows** **PowerShell** 아이콘을 선택합니다.

8.  열린 명령 프롬프트에서 다음 명령을 입력하고 Enter 를 눌러 Azure CLI 에 로그인합니다.

<!-- end list -->

    az login

9.  표시되는 브라우저 창에서 다음 작업을 수행합니다.
    
    1.  Microsoft 계정의 **전자 메일 주소** 를 입력합니다.
    
    2.  **다음** 을 선택합니다.
    
    3.  Microsoft 계정의 **비밀번호** 를 입력합니다.
    
    4.  **로그인** 을 선택합니다.

10. 현재 열려 있는 **명령 프롬프트** 응용 프로그램으로 돌아갑니다. 로그인 프로세스가 완료될 때까지 기다립니다.

11. 다음 명령을 입력하고 Enter 를 눌러 **ManagedPlatform** 리소스 그룹의 모든 **어플** 을 나열합니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform

12. 다음 명령을 입력하고 Enter 를 눌러 접두사 **imgweb\*** 가 있는 **어플** 을 찾습니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform --query "[?starts_with(name, 'imgweb')]"

13. 다음 명령을 입력하고 Enter 를 눌러 접두사 **imgweb\*** 가 있는 싱글 어플의 이름만 인쇄합니다.

<!-- end list -->

    az webapp list --resource-group ManagedPlatform --query "[?starts_with(name, 'imgweb')].{Name:name}" --output tsv

14. 다음 명령을 입력하고 Enter 를 눌러 현재 디렉터리를 랩 파일이 포함된 **Allfiles (F):\\Labfiles\\02\\Starter\\Web** 디렉토리로 변경합니다.

<!-- end list -->

    cd F:\Labfiles\02\Starter\Web\

15. 다음 명령을 입력하고 Enter 를 눌러 이전에 랩에서 만든 **웹 어플** 에 **web.zip** 파일을 배치합니다.

<!-- end list -->

    az webapp deployment source config-zip --resource-group ManagedPlatform --src web.zip --name <name-of-your-web-app>

> > **참고**: **\<Web-ing-your-web-app\>** 플레이스 홀더를 이전에 랩에서 만든 웹 어플의 이름으로 바꿉니다. 최근에 이전 단계에서 이 어플의 이름을 쿼리했습니다.

16. 이 랩을 진행하기 전에 배치가 완료될 때까지 기다립니다.

17. 포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

18. **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

19. **관리 플랫폼** 블레이드에서 이전엔 랩에서 만든 **imgweb\*** 웹 어플을 선택합니다.

20. **웹 어플** 블레이드에서 **찾아보기** 를 선택합니다.

21. 갤러리의 이미지 목록을 관찰합니다. 갤러리는 랩의 초기에 Azure Storage 에 업로드된 싱글 이미지를 나열해야 합니다.

22. **Contoso 포토 갤러리** 웹 페이지 상단에서 **새 이미지 업로드** 섹션을 찾아 다음 작업을 수행합니다.
    
    5.  **찾아보기** 를 선택합니다.
    
    6.  열리는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Images** 으로 이동하여 **bahnmi.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.
    
    7.  **업로드** 를 선택합니다.

23. 갤러리 이미지 목록이 새 이미지로 업데이트되었는지 확인합니다.

> > **참고**: 드문 경우지만 새 이미지가 표시되도록 브라우저 창을 새로 고쳐야 할 수도 있습니다.

24. **Azure portal** 을 표시하는 브라우저 창으로 돌아갑니다.

#### 검토

이 연습에서는 Azure Web App 을 만들고 기존 웹 응용 프로그램의 코드를 클라우드의 리소스에 배치했습니다.

### 연습 3: Azure 저장소 및 Azure 함수를 사용하여 백그라운드 처리 작업을 만듭니다.

#### 작업 1: 함수 어플 만들기

1.  Azure 포털 왼쪽 탐색네비게이션 페인에서 **+ 리소스 만들기** 를 선택합니다.

2.  **새** 블레이드 상단에서 **마켓플레이스 검색** 필드를 찾습니다.

3.  검색 필드에 **함수** 를 입력하고 Enter 를 누릅니다.

4.  **모든** 검색 결과 블레이드에서 **함수** **어플** 결과를 선택합니다.

5.  **함수** **어플** 블레이드에서 **만들기** 를 선택합니다.

6.  두 번째 **함수** **어플** 블레이드에서 다음 작업을 수행합니다.
    
    1.  **어플 이름** 필드에 **imgfunc\[*your name in lowercase*\]** 를 입력합니다.
    
    2.  **구독** 필드를 기본값으로 설정합니다.
    
    3.  **리소스 그룹** 섹션에서 **기존 사용** 을 선택한 다음 **관리되는 플랫폼** 을 선택합니다.
    
    4.  **OS** 섹션에서 **Windows** 를 선택합니다.
    
    5.  **호스팅 계획** 목록에서 **소비 계획** 을 선택합니다.
    
    6.  **위치** 목록에서 **미국 동부** 를 선택합니다.
    
    7.  **런타임 스택** 목록에서 **.NET** 을 선택합니다.
    
    8.  **저장소** 섹션에서 **기존 사용** 을 선택한 다음 이전에 랩에서 만든 **imgstor\* ** 저장소 계정을 선택합니다.
    
    9.  **응용 프로그램 인사이트** 필드를 기본값으로 설정합니다.
    
    10. **만들기** 를 선택합니다.

7.  이 랩을 진행하기 전에 만들기 태스크 완료될 때까지 기다립니다.

#### 작업 2: 블랍을 처리하는 함수를 작성합니다.

1.  포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

2.  **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 찾아 선택합니다.

3.  **관리 플랫폼** 블레이드에서 이전엔 랩에서 만든 **imgfunc\*** 함수 어플을 선택합니다.

4.  **함수 어플** 블레이드에서 **+ 새 함수** 를 선택합니다.

5.  **새 Azure Function** 빠른 시작에서 다음 작업을 수행합니다.
    
    1.  **개발 환경 선택** 헤더에서 **포털에** 를 선택합니다.
    
    2.  **계속** 을 선택합니다.
    
    3.  **함수 만들기** 헤더에서 **더 많은 템플릿...** 을 선택합니다.
    
    4.  **템플릿 완료 및 보기** 를 선택합니다.
    
    5.  **템플릿** 목록에서 **Azure 블랍 저장소 트리거** 를 선택합니다.
    
    6.  **확장이 설치되지 않음** 창에서 **설치** 를 선택합니다.

> > **참고**: Azure 저장소 블랍을 사용하여 작업하기 위한 확장을 설치할 때 최대 2분이 걸릴 수 있습니다. 포털이 새로 고쳐지지 않으면 **설치되지 않은 확장** 팝업 창을 닫고 **Azure 블랍 저장소 트리거** 를 다시 선택하기만 하면 됩니다.

7.  설치가 성공하면 **계속** 을 선택합니다.

8.  **새 함수** 창에서 **이름** 필드에 **ImageManager** 를 입력합니다.

9.  **새 함수** 창에서 **경로** 필드에 **이미지/{이름}** 을 입력합니다.

10. **새 함수** 창에서 **저장소 계정 연결** 목록에서 **AzureWebJobsStorage** 을 선택합니다.

11. **새 함수** 창에서 **만들기** 를 선택합니다.

<!-- end list -->

6.  함수 편집기의 오른쪽에서 **파일 보기** 를 선택하여 탭을 엽니다.

7.  **파일 보기** 탭에서 **업로드** 를 선택합니다.

8.  열리는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter** 으로 이동하여 **function.proj** 파일을 선택한 다음 **열기** 를 선택합니다.

9.  **파일 보기** 탭에서 **function.json** 파일을 선택하여 함수 구성에 편집기를 봅니다.

10. JSON 편집기에서 현재 구성을 관찰합니다.

<!-- end list -->

    {
      "bindings": [
        {
          "name": "myBlob",
          "type": "blobTrigger",
          "direction": "in",
          "path": "images/{name}",
          "connection": "AzureWebJobsStorage"
        }
      ],
      "disabled": false
    }

11. Replace the entire contents of the JSON configuration file with the following JSON content:

<!-- end list -->

    {
      "bindings": [
        {
          "name": "inputBlob",
          "type": "blobTrigger",
          "direction": "in",
          "path": "images/{name}",
          "connection": "AzureWebJobsStorage"
        },
        {
          "type": "blob",
          "name": "outputBlob",
          "path": "images-thumbnails/{name}",
          "connection": "AzureWebJobsStorage",
          "direction": "out"
        }
      ]
    }

12. 편집기에서 **저장** 을 선택하여 변경 내용을 구성에 유지합니다.

13. **파일 보기** 탭에서 **run.csx** 파일을 선택하여 **ImageManager** 함수의 편집기로 돌아갑니다.

14. **파일 보기** 탭을 최소화합니다.

> > **참고**: 탭 헤더의 오른쪽에 있는 화살표를 즉시 선택하여 탭을 최소화할 수 있습니다.

15. 함수 편집기에서 예시 함수 스크립트를 관찰합니다.

<!-- end list -->

    public static void Run(Stream myBlob, string name, ILogger log)
    {
        log.LogInformation($"C# Blob trigger function Processed blob\n Name:{name} \n Size: {myBlob.Length} Bytes");
    }

16. 예시 코드를 모두 **삭제** 합니다.

17. 편집기 내에서 다음 자리 표시자 함수를 복사하여 붙여넣습니다.

<!-- end list -->

    using SixLabors.ImageSharp;
    using SixLabors.ImageSharp.PixelFormats;
    using SixLabors.ImageSharp.Processing;
    using SixLabors.ImageSharp.Formats.Jpeg;
    using SixLabors.Primitives;
    
    public static void Run(Stream inputBlob, Stream outputBlob, string name, ILogger log)
    {
    }

18. **저장** 을 선택하여 변경 내용을 저장하고 Word 를 닫습니다.

19. **실행** 메서드 내에 다음 코드 줄을 추가하여 함수 실행에 대한 정보를 기록합니다.

<!-- end list -->

    log.LogInformation($"C# Blob trigger function Processed blob\n Name:{name} \n Size: {inputBlob.Length} Bytes");

20. 입력 블랍에 대한 **스트림** 을 이미지 라이브러리에 로드하려면 다음 **사용** 블록을 추가합니다.

<!-- end list -->

    using (Image<Rgba32> image = Image.Load(inputBlob))
    {
    }

21. **사용** 블록 내에 다음 코드 줄을 추가하여 이미지 크기를 조정하고 그레이스케일 필터를 적용하여 이미지를 변경합니다.

<!-- end list -->

    image.Mutate(i => 	
        i.Resize(new ResizeOptions { Size = new Size(250, 250), Mode = ResizeMode.Max }).Grayscale()
    );

22. 다음 코드 줄을 추가하여 출력 블랍의 **스트림** 에 새 이미지를 저장합니다.

<!-- end list -->

    image.Save(outputBlob, new JpegEncoder());

23. **실행** 메서드는 이제 다음과 유사해야 합니다.

<!-- end list -->

    using SixLabors.ImageSharp;
    using SixLabors.ImageSharp.PixelFormats;
    using SixLabors.ImageSharp.Processing;
    using SixLabors.ImageSharp.Formats.Jpeg;
    using SixLabors.Primitives;
    
    public static void Run(Stream inputBlob, Stream outputBlob, string name, ILogger log)
    {
        log.LogInformation($"C# Blob trigger function Processed blob\n Name:{name} \n Size: {inputBlob.Length} Bytes");
        using (Image<Rgba32> image = Image.Load(inputBlob))
        {
            image.Mutate(i => 	
                i.Resize(new ResizeOptions { Size = new Size(250, 250), Mode = ResizeMode.Max }).Grayscale()
            );
            image.Save(outputBlob, new JpegEncoder());
        }
    }

24. **저장** 을 선택하여 스크립트를 저장하고 코드를 다시 컴파일합니다.

#### 작업 3: 웹 솔루션 검증

1.  포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

2.  **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

3.  **관리플랫폼** 블레이드에서 이전에 랩에서 만든 **imgstor\*** 저장소 계정을 선택합니다.

4.  **저장소 계정** 블레이드에서 블레이드 왼쪽에 있는 **블랍 서비스** 섹션에서 **블랍** 링크를 선택합니다.

5.  **블랍** 섹션에서 **이미지** 컨테이너를 선택합니다.

6.  **컨테이너** 블레이드에서 **업로드** 를 선택합니다.

7.  표시되는 **블랍 업로드** 창에서 다음 작업을 수행합니다.

<!-- end list -->

1.  **파일** 섹션에서 **폴더** 아이콘을 선택합니다.

2.  열리는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Images**으로 이동하여 **veggie.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.

3.  **파일이 이미 존재하는 경우 덮어쓰기** 확인란이 선택되어 있는지 확인합니다.

4.  **업로드** 를 선택힙니다.

<!-- end list -->

8.  이 랩을 계속하기 전에 블랍이 업로드될 때까지 기다립니다.

9.  **컨테이너** 블레이드를 닫습니다.

10. **블랍** 섹션으로 돌아가서 **이미지-섬네일** 컨테이너를 선택합니다.

11. **컨테이너** 블레이드에서 **이미지-섬네일** 컨테이너에서 새로 만든 **veggie.jpg** 파일을 관찰합니다.

> > **참고**: 새 이미지가 표시되려면 1~5분 정도 걸릴 수 있습니다.

12. **이미지-섬네일** 컨테이너에서 **veggie.jpg** 블랍을 선택합니다.

13. **블랍** 블레이드에서 **블랍 편집** 탭을 선택합니다.

14. 블랍의 내용을 관찰합니다. 웹 페이지는 컨테이너에 업로드된 이미지를 렌더링합니다.

15. 포털의 왼쪽 네비게이션 페인에서 **리소스 그룹** 을 선택합니다.

16. **리소스 그룹** 블레이드에서 이전에 랩에서 만든 **ManagedPlatform** 리소스 그룹을 선택합니다.

17. **관리 플랫폼** 블레이드에서 이전엔 랩에서 만든 **imgweb\*** 웹 어플을 선택합니다.

18. **웹 어플** 블레이드에서 **찾아보기** 를 선택합니다.

19. 갤러리의 이미지 목록을 관찰합니다. 이제 새 섬네일 이미지로 섬네일 그림 목록을 업데이트해야 합니다.

20. **Contoso 포토 갤러리** 웹 페이지 상단에서 **새 이미지 업로드** 섹션을 찾아 다음 작업을 수행합니다.
    
    1.  **찾아보기** 를 선택합니다.
    
    2.  열리는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Images** 로 이동하여 **blt.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.
    
    3.  **업로드** 를 선택합니다.

21. **Contoso 포토 갤러리** 웹 페이지 상단에서 **새 이미지 업로드** 섹션을 찾아 다음 작업을 수행합니다.
    
    4.  **찾아보기** 를 선택합니다.
    
    5.  열리는 파일 탐색기 대화 박스에서 **Allfiles (F):\\Labfiles\\02\\Starter\\Images** 로 이동하여 **sub.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.
    
    6.  **업로드** 를 선택합니다.

22. **Contoso 포토 갤러리** 웹 페이지 상단에서 **새 이미지 업로드** 섹션을 찾아 다음 작업을 수행합니다.
    
    7.  **찾아보기** 를 선택합니다.
    
    8.  열리는 파일 탐색기 대화 박스에서 ** Allfiles (F):\\Labfiles\\02\\Starter\\Images ** 로 이동하여 **burger.jpg** 파일을 선택한 다음 **열기** 를 선택합니다.
    
    9.  **업로드** 를 선택합니다.

23. 갤러리 이미지 목록이 새 이미지로 업데이트되었는지 확인합니다.

24. 페이지 상단의 미리보기 이미지 목록을 관찰합니다. 네 개의 미리보기 이미지가 모두 생성될 때까지 매분 마다 페이지를 새로 고칩니다.

#### 검토

이 연습에서는 함수에서 이미지 수정 및 크기 조정에 대한 계산 집약적인 작업을 처리하기 위해 백그라운드 처리 작업을 만들었습니다.

### 연습 4: 구독 정리 

#### 작업 1: 클라우드 셸 열기

1.  포털 상단에서 **클라우드 셸** 아이콘을 선택하여 새 셸 인스턴스를 엽니다.

2.  포털 하단의 **클라우드 셸** 명령 프롬프트에서 다음 명령을 입력하고 Enter 를 눌러 구독의 모든 리소스 그룹을 나열합니다.

<!-- end list -->

    az group list

3.  다음 명령을 입력하고 Enter 를 눌러 리소스 그룹을 삭제할 수 있는 명령 목록을 봅니다.

<!-- end list -->

    az group delete --help

#### 작업 2: 리소스 그룹 삭제

1.  다음 명령을 입력하고 Enter 를 눌러 **ManagedPlatform** 리소스 그룹을 삭제합니다.

<!-- end list -->

    az group delete --name ManagedPlatform --no-wait --yes

2.  포털 하단의 **클라우드 셸** 페인을 닫습니다.

#### 작업 3: 액티브 응용 프로그램 닫기

1.  현재 실행 중인 **Microsoft Edge** 응용 프로그램을 닫습니다.

2.  현재 실행 중인 **Visual Studio Code** 응용 프로그램을 닫습니다.

#### 검토

이 연습에서는 이 랩에 사용된 **리소스 그룹** 을 제거하여 구독을 정리했습니다.
